function hideOrShowArticlesBlock(a){$("#blog").hasClass("centry_thumbs")&&($("#articles_container div.article_item").css("visibility",a?"visible":"hidden"),a?timeoutArticlesResize&&clearTimeout(timeoutArticlesResize):timeoutArticlesResize=setTimeout(function(){hideOrShowArticlesBlock(1)},3e3))}function initBlog(){hideOrShowArticlesBlock();if(window.fromperso){var a=window.parent.document.getElementById("perso30frame");a.style.height=document.body.offsetHeight+"px",document.body.style.overflow="hidden",document.body.parentNode.style.overflow="hidden";var b=document.getElementById("previsu");b.style.height=parseInt(document.body.offsetHeight)+"px"}}function resizeColumns(){if(!!window.idtpl&&idtpl==250)return;var a=$("#blog")[0];if(!hasClass(a,"centry")){var b=$("#footer")[0],c=$("#wrapper")[0],d=$("#blogcontent")[0],e=$("#sidebar-right")[0],f=$("#sidebar-left")[0],g=$("#barleft")[0],h=$("#currentbp")[0];b||(b={},b.offsetHeight=0);if(!(!hasClass(a,"sidebar_one")&&(!f||!d||!e)||hasClass(a,"sidebar_one")&&(!c||!g)))if(!hasClass(a,"sidebar_one")){_([f,d,e]).each(function(a){a.style.minHeight=""});var i=Math.max(parseInt(f.offsetHeight),parseInt(d.offsetHeight),parseInt(e.offsetHeight)),j=0,k=42;h&&(j=parseInt(h.offsetHeight)-2),f.style.minHeight=i+k-j+"px",d.style.minHeight=i+"px",e.style.minHeight=i+k+"px"}else{d.style.minHeight="";var i=parseInt(d.offsetHeight),l=getStylePropertyValueWithRoot,m=g,j=parseInt(l(document,g,"padding-top"))+parseInt(l(document,g,"padding-bottom"))+parseInt(l(document,g,"border-top-width"))+parseInt(l(document,g,"border-bottom-width")),n=l(document,d,"background-color");n&&(n=n.replace(/ /g,""))&&(n=="transparent"||n.match(/rgba\(\d+,\d+,\d+,0\)/))&&(j+=parseInt(l(document,d,"padding-bottom")));var i=i-j;g.style.minHeight=i+"px",d.style.minHeight=i+"px"}}}function resizePersoFrame(){resizeColumns()}function centryTopbarVisibility(a,b,c,d,e,f,g){a==1?(addClass(c,"show"),removeClass(c,"hide"),removeClass(b,"active")):(addClass(c,"hide"),removeClass(c,"show"),addClass(b,"active")),b.innerHTML=a?e:d,b.title=a?g:f}function displayCentryTopbar(a,b,c,d,e,f){var g=document.getElementById("barleft_button"),h=document.getElementById("barleft_content");if(b)var i=getcookie("centryTopbarDisplaySet",a);else var i=a;centryTopbarVisibility(i,g,h,c,d,e,f),g.onclick=function(a){hasClass(h,"hide")?(centryTopbarVisibility(1,g,h,c,d,e,f),setcookie("centryTopbarDisplaySet",1)):(centryTopbarVisibility(0,g,h,c,d,e,f),setcookie("centryTopbarDisplaySet",0)),a.preventDefault?a.preventDefault():a.returnValue=!1}}function resizeArticlesThumbs(){if($("#blog").hasClass("centry_thumbs")){var a=$("#articles_container").find(".article_item"),b=40,c=28,d=10,e=2,f=3,g=0;for(var h=0;h<a.length/f;h++){var i=h*f;g=0;for(var j=0;j<f;j++){var k=a.eq(j+i),l=k.find(".post").height();l>g&&(g=l)}for(var j=0;j<f;j++){var k=a.eq(j+i),m=g>=300?300+e:g+e,n=b+m+c+d;k.height(n),k.find(".thumbs_infos").height(n).css("lineHeight",n+"px"),k.find(".post").height(m).css("lineHeight",m+"px")}}hideOrShowArticlesBlock(1)}}function openCommentsWindow(a){var b=this==window?a:this;return openWindow(b.href,"coms_"+blog_pseudo.replace(/-/g,"_"),755,600)}function openKiffsWindow(a){var b=this==window?a:this;return openWindow(b.href,"kiffs_"+blog_pseudo.replace(/-/g,"_"),755,600)}function openAddVipWindow(a){var b=this==window?a:this;return openWindow(b.href,"vip_"+blog_pseudo.replace(/-/g,"_"),540,250)}function openAddFriendWindow(a){var b=this==window?a:this;return openWindow(b.href,"friends_"+blog_pseudo.replace(/-/g,"_"),540,320)}function openShareWindow(a){var b=this==window?a:this;return openWindow(b.href,"share_"+blog_pseudo.replace(/-/g,"_"),800,800)}function openPhotoWindow(a){return openWindow(a.href,"photo_"+blog_pseudo.replace(/-/g,"_"),640,600)}function right(a){return navigator.appName=="Microsoft Internet Explorer"&&event.button==2?(typeof msgAntiClick!="undefined"&&alert(msgAntiClick),!1):!0}function trap(){if(document.images)for(var a=0;a<document.images.length;a++)document.images[a].oncontextmenu=function(a){return!1}}function loginAndKiff(a){var b=window.location.href.replace(/([#].*)$/gi,""),c=b+(b.indexOf("?")>0?"&":"?")+"connect=1&kiff="+escape(a)+"&k="+escape(tu_kiffes_les_legumes_ou_pas);window.location.href=c}function kiffArticle(c,d,e){var f=blog_id_skynaute,g=tu_kiffes_les_legumes_ou_pas;e=e||"blog",e=="allohollande"?(kiff_url="kiffer.php",prefixes=["#new-","#kiffs-","#videos-"]):e=="texthollande"?(kiff_url="kiffer.php",prefixes=["#texthollande-"],f=85805128,typeof texthollande_csrf_kiff!="undefined"&&texthollande_csrf_kiff!==null&&(g=texthollande_csrf_kiff)):(kiff_url=blog_spath+"like.php",prefixes=["#"]);var h=new Array,i=new Array,j="like_on",k="like_off",l="s"+d,m,n,o=escape(window.document.referrer);for(var p=0;p<prefixes.length;p++)a=$(prefixes[p]+"kiff-action-"+d+" a")[0],b=$(prefixes[p]+"kiff-"+d)[0],a&&b&&(h.push(a),i.push(b));h.length>0&&i.length>0&&!kiffArticles[l]&&(kiffArticles[l]=1,n=hasClass(h[0],j)?"del":"add",$.ajax({url:kiff_url,type:"POST",data:{t:(new Date).getTime(),action:n,id_skynaute:f,id_article:d,r:o,k:g},success:function(c){if(typeof c=="string"&&c=="KIFF_ERROR_USER_NOT_LOGGED")loginAndKiff(d);else if(c&&typeof c=="object"){var e=c;if(c.action)for(var f=0;f<h.length;f++)a=h[f],b=i[f],a.title=c.count_title,b.innerHTML=c.count_html,m=c.has,addClass(a,m?j:k),removeClass(a,m?k:j)}kiffArticles[l]=0}}))}function commentEvent(a,b){$("#secondary_content").on("submit",".jsCommentDelete",function(c){c.preventDefault(),c.stopPropagation();if(!confirm(b))return!1;$.ajax({url:$(this).attr("action"),type:"POST",data:$(this).serialize()+"&_skyajax_=1",success:function(b){if(b.status=="delete_ok"){var c=document.getElementById("c-"+b.deleted_comment);c&&(addClass(c,"delete-confirmed"),c.innerHTML=a,resizeColumns())}}})})}function commentAddEvent(a,b,c,d,e,f,g){var h=function(){var b=document.getElementById("body_"+a);if(!b)return;addEvent(b,"focus",function(){timeoutCommentForm&&clearTimeout(timeoutCommentForm),focusCommentFormBody(a)}),addEvent(b,"keyup",function(){timeoutCommentForm&&clearTimeout(timeoutCommentForm)}),$(b).autogrow()},i=function(b){var c=document.getElementById("comment_form_submit_"+a);if(c){c.disabled=!0;var e=function(){c.disabled=!1;if(!h)return;clearTimeout(h),h=!1},h=setTimeout(function(){c.disabled=!1},2e4)}var i=document.getElementById("jsCommentConfirmation_"+a);i&&(i.style.visibility="hidden"),$.ajax({url:b.action,type:"POST",data:$(b).serialize()+"&_skyajax_=1",success:function(a){e();var b=document.getElementById("nb_comment_"+a.id_article),c=document.getElementById("comment_counter_"+a.id_article),d=document.getElementById("comment_add_"+a.id_article),h=document.getElementById("blogcomments"),i=document.getElementById("secondary_content");b&&(b.innerHTML=a.nb_comment,hasClass(c,"hide")&&(removeClass(c,"hide"),c.removeAttribute("class"))),d&&$(d).html(a.comment_zone),i&&!g&&(h?$(h).html(a.comment_added):(h=document.createElement("div"),h.id="blogcomments",h.innerHTML=a.comment_added,i.appendChild(h))),j(),timeoutCommentFormConfirm&&clearTimeout(timeoutCommentFormConfirm),timeoutCommentFormConfirm=setTimeout(function(){var b=document.getElementById("jsCommentConfirmation_"+a.id_article);b&&addClass(b,"hide"),resizeColumns()},15e3),f==0&&(timeoutCommentForm&&clearTimeout(timeoutCommentForm),timeoutCommentForm=setTimeout(function(){d&&addClass(d,"hide")},15e3)),resizeColumns()},error:function(){alert(d),e()}})},j=function(){var f=document.getElementById("comment_add_"+a);if(f&&hasClass(f,"jsCommentAdd")){var g=document.getElementById("add_comment_form_"+a);g&&addEvent(g,"submit",function(a){var b=a.target||a.srcElement;if($(b).find("input[name=connect]").length)return $(b).attr("action",$(b).attr("action")+"&connect=1"),!0;i(b,d),a.preventDefault(),a.stopPropagation()})}b&&(focusCommentFormBody(a),autofocus.init("body_"+a)),h(),c&&optionsCommentFormEvent(a,e)};j()}function showCommentForm(a,b){var c=document.getElementById("comment_add_"+a);if(!c||!hasClass(c,"hide"))return;var d=document.getElementById("a-"+a),e=getElementsByClassName("jsCommentAdd",d,"div"),f=getElementsByClassName("jsCommentConfirmation",d,"div");for(var g=0;g<e.length;g++)addClass(e[g],"hide");for(var g=0;g<f.length;g++)addClass(f[g],"hide");timeoutCommentForm&&(clearTimeout(timeoutCommentForm),timeoutCommentForm=!1),timeoutCommentFormConfirm&&(clearTimeout(timeoutCommentFormConfirm),timeoutCommentFormConfirm=!1),renderCaptcha("captcha_blog_comment_",a),removeClass(c,"hide");var h=document.getElementById("body_"+a);h&&h.focus(),focusCommentFormBody(a),removeClass(c,"hide");var h=document.getElementById("body_"+a);h&&h.focus(),focusCommentFormBody(a)}function renderCaptcha(a,b){$.ajax({type:"GET",dataType:"json",url:"/common/ajax_captcha.php",data:"external_id="+b,success:function(c){c.need_captcha==1&&($("#"+a+b).html(c.captcha),resizeColumns())},error:function(a){console.log(a)}})}function showCommentResponseForm(a){var b=document.getElementById("blog_comment_repondre_"+a),c=getElementsByClassName("jsCommentResponseAdd",document.body,"form");for(var d=0;d<c.length;d++)addClass(c[d],"hide");renderCaptcha("captcha_reply_",a),b&&(removeClass(b,"hide"),$("#body_repondre_"+a).autogrow().focus()),resizeColumns()}function focusCommentFormBody(a){var b=document.getElementById("comment_options_"+a);b&&(removeClass(b,"hide"),resizeColumns())}function optionsCommentFormEvent(a,b){var c=document.getElementById("prenom_"+a);c&&(addEvent(c,"focus",function(a){var c=a.target||a.srcElement;c.value==b&&(c.value="")}),addEvent(c,"blur",function(a){var c=a.target||a.srcElement;c.value==""&&(c.value=b)}));var d=document.getElementById("post_anonyme_"+a);d&&addEvent(d,"click",function(a){var b=a.target||a.srcElement,c=b.id.replace("post_anonyme_",""),e=document.getElementById("comment_pseudo_edit_"+c);d.checked==1?removeClass(e,"hide"):addClass(e,"hide")})}var kiffArticles=[],timeoutArticlesResize=null,timeoutCommentForm=null,timeoutCommentFormConfirm=null;onload_funcs.push(initBlog),onload_funcs.push([resizeArticlesThumbs,1]),onload_funcs.push([resizeColumns,1])